{% extends "base.html" %}
{% block pagetitle %} Orders {% endblock %}

{% block content %}
<h2>Orders</h2>
<span>
    <a href="{{ url_for('home') }}">Home</a> /
    <a href="{{ url_for('orders.view_orders') }}">Orders</a>
</span>
<table>
    <!-- Headers -->
    <tr>
        <th>Id</th>
        <th>Items</th>
        <th>Customer</th>
        <th>Created</th>
        <th>Amount</th>
        <th>Details</th>
    </tr>

    {% for order in orders %}
    <tr>
        <td>{{ order.id }}</td>
        <td>
            <ol>
                {% for product in order.items %}
                <li>
                    {{ product.product.name }}
                </li>
                {% endfor %}
            </ol>
        </td>
        <td>
            <a href="{{ url_for('customers.details', id=order.customer.id) }}">
                {{ order.customer.name }}
            </a>
        </td>
        <td>{{ order.created }}</td>
        <td>${{ order.estimate() }}</td>
        <td>
            <a href="{{ url_for('orders.details', id=order.id) }}">View Order</a>
        </td>

        {% if not order.completed %}
        <td>
            <form method="post" action="{{ url_for('orders.complete', id=order.id) }}">
                <button type="submit">Complete Order</button>
            </form>
        </td>
        {% else %}
        <td>Completed</td>
        {% endif %}
    
    </tr>
    {% endfor %}
</table>


{% endblock %}